parameters:

  command_bus.queue_name: culturefeed-udb3
  resque.command.bus.event_command_context_set: broadway.command_handling.context
  culturefeed_udb3.export_folder_location: 'public://downloads'

services:

  culturefeed_udb3.event_export:
    class: CultuurNet\UDB3\EventExport\EventExportService
    # We need to use a factory here to be able to resolve the public:// Drupal
    # stream wrapper to its real path
    factory: [Drupal\culturefeed_udb3\EventExport\EventExportServiceFactory, create]
    arguments:
      - '@culturefeed_udb3.event_service'
      - '@culturefeed_udb3.search_service'
      - '@culturefeed_udb3.uuid_generator'
      - '%culturefeed_udb3.export_folder_location%'
      - '@culturefeed_udb3.event_export.iri_generator'
      - '@culturefeed_udb3.event_export.mailer'
  culturefeed_udb3.event_export.iri_generator:
    class: Drupal\culturefeed_udb3\LocalFileIriGenerator
  culturefeed_udb3.event_export.mailer:
    class: Drupal\culturefeed_udb3\EventExport\NotificationMailer
    arguments: ['@plugin.manager.mail']
